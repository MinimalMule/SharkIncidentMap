<!DOCTYPE html>

<html>
<head>
<link 
  rel="stylesheet" 
  type="text/css" 
  href="https://unpkg.com/globeletjs@latest/dist/globelet.css">
<link rel="stylesheet" type="text/css" href="styles.css">
</head>
    <body>
		<div id="globe" class="globelet">
			<div class="main">
				<canvas class="map"></canvas>
				<div class="status"></div>
			</div>
			<div class="infoslider"></div>
		</div>
		<script type="module">
			import * as globeletjs from "https://unpkg.com/globeletjs@latest/dist/globelet.js";
			const params = { container: 'globe',
				style: "./style2.json",
				center: [-100, 38.5],
				altitude: 6280,
				};
			const globePromise = globeletjs.initGlobe(params);
			
			globe.startAnimation()
			
			//open the text file
			fetch('./sharklocdat.txt')
				.then(response => {
					// send an error if there's a problem
					if (!response.ok) {
						throw new Error(`HTTP error! Status: ${response.status}`);
					}
					return response.text();
				})
				// if there's no problem then read line by line
				.then(textContent => {
					// get the text.
					const parsedString = textContent.split('\n').map((line) => line.split('\t'));
				
					for (let i = 1; i < parsedString.length; i++) {
						var day = parsedString[i][0];
						var month = parsedString[i][1];
						var year = parsedString[i][2];
						var injury = parsedString[i][3];
						var latitude = parsedString[i][6];
						var longitude = parsedString[i][7];
						var sharkType = parsedString[i][8];
						

						const options = {position = [latitude, longitude]}
						
						const marker = globeAPI.addMarker(options);
							
						
						// spit out the output to the console so that we can check
						console.log("Day: %s, Month: %s, Year: %s, Injury: %s, Latitude: %s, Longitude: %s, Shark Type: %s ", day, month, year, injury, latitude, longitude, sharkType);
					} 

					})
					.catch(error => {
						// catch errors
						console.error('Fetch error:', error);
					});		
		</script>
    </body>
</html>